(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{1077:function(t,e){},1091:function(t,e){},542:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=f(a(38)),s=f(a(384)),r=f(a(130)),i=f(a(74)),o=f(a(11)),l=f(a(19)),u=f(a(146)),c=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();a(37),a(385),a(169),a(94),a(26),a(20),a(145);var d=f(a(13));function f(t){return t&&t.__esModule?t:{default:t}}var m=u.default.TreeNode,h=function(e){function a(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));n.getByProduct=function(){d.default.get("/hcm/hcmCustomModel/getByProduct",{params:{productClassifyid:n.state.id}}).then(function(t){var e=t.data.data;n.setState({dataList:e})}).catch(function(t){l.default.error(t.statusText)})},n.num=100,n.formAtDom=function(e){var a=[],l=n.state.dataList,u=n.state.showid;if(e){var c=function(e){a.push(t.createElement("div",{className:"item",key:Math.random()},t.createElement("p",null,l[e].title),t.createElement("div",{className:"info"},l[e].data.map(function(a,l){return a.edit?t.createElement("div",{key:l,className:"inputbox"},t.createElement("input",{ref:a.id,defaultValue:a.fieldname,className:"editinput"}),t.createElement("span",{className:"anticonbox"},t.createElement(o.default,{onClick:function(){return n.onSubItem(e,l)},type:"check"}),t.createElement(o.default,{onClick:function(){return n.onEdititem(e,a,l,!1)},type:"close"}))):t.createElement("div",{key:l,onMouseMove:function(){return n.onMouseOver(e,a,l)},className:"checkbox"},t.createElement(r.default,{onChange:function(t){return n.oCheckitem(t,e,a,l)},disabled:"1"==a.fieldRequired,checked:a.isChecked},t.createElement(i.default,{placement:"topLeft",title:a.fieldname},a.fieldname)),"1"==a.fieldRequired?null:a.id==u?t.createElement("span",{className:"anticonbox"},t.createElement(o.default,{onClick:function(){return n.onEdititem(e,a,l,!0)},type:"edit"}),t.createElement(s.default,{title:t.createElement("div",null,t.createElement("p",{style:{fontWeight:"bold"}},"你确定要删除该字段吗？"),t.createElement("p",null,"删除后录入的信息会被删除")),onConfirm:function(){return n.onRmitem(e,a,l)},okText:"确定",cancelText:"取消"},t.createElement(o.default,{type:"delete"}))):null)}),t.createElement("div",{className:"inputbox"},l[e].addStatus?t.createElement(t.Fragment,null,t.createElement("input",{ref:e,className:"editinput"}),t.createElement("span",{className:"anticonbox"},t.createElement(o.default,{onClick:function(){return n.addSubItem(e)},type:"check"}),t.createElement(o.default,{onClick:function(){return n.addButStatus(e,!1)},type:"close"}))):t.createElement("a",{onClick:function(){return n.addButStatus(e,!0)}},t.createElement(o.default,{style:{paddingRight:"6px"},type:"plus-circle-o"}),"新增")))))};for(var d in l)c(d)}else{var f=function(t){l[t].data.forEach(function(e,n){if(e.isChecked)return e.target=[t,n,e.fieldRequired],a.push(e)})};for(var d in l)f(d)}return a},n.onDrop=function(t){n.setState({endId:t.node.props.eventKey},function(){var e=t.node.props.pos.split("-"),a=t.dropPosition-Number(e[e.length-1]),s=n.state,r=s.stateID,i=s.endId,o=r.split(","),l=i.split(","),u=n.state.dataList,c=u[l[0]].data[l[1]].sort,d=u[o[0]].data[o[1]].sort;0===a?(u[l[0]].data[l[1]].sort=d,u[o[0]].data[o[1]].sort=c):a>0?u[o[0]].data[o[1]].sort=c+.01:a<0&&(u[o[0]].data[o[1]].sort=c-.01),n.setState({dataList:u})})},n.onDragStart=function(t){n.setState({stateID:t.node.props.eventKey})},n.canCelItem=function(t){console.log(t),n.oCheckitem({target:{checked:0}},t.target[0],t,t.target[1])};var u=n.props.params,c=u.id,f=u.name,m=u.status;return n.state={id:c,name:f,status:m,dataList:{},showid:null,stateID:null,endId:null},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,t.Component),c(a,[{key:"componentDidMount",value:function(){this.getByProduct()}},{key:"onMouseOver",value:function(t,e,a){var n=this.state.dataList,s=this.state.showid;n[t].data[a].id!=s&&(s=n[t].data[a].id,this.setState({showid:s}))}},{key:"onRmitem",value:function(t,e,a){var n=this,s=this.state.dataList;d.default.get("/hcm/hcmCustomModel/delete",{params:{id:s[t].data[a].id,module:"PRODUCT"}}).then(function(t){l.default.success(t.data.message),n.getByProduct()}).catch(function(t){l.default.error(t.statusText)})}},{key:"onEdititem",value:function(t,e,a,n){var s=this.state.dataList;s[t].data[a].edit=n,this.setState({data:s,showid:null})}},{key:"onSubItem",value:function(t,e){var a=this,n=this.state.dataList,s=n[t].data[e];this.refs[s.id].value.trim().length?this.refs[s.id].value.trim().length>20?l.default.error("字段名过长 请限制在20字符以内"):(n[t].data[e].edit=!1,n[t].data[e].fieldname=this.refs[s.id].value,d.default.get("/hcm/hcmCustomModel/save",{params:{id:s.id,productClassifyId:this.state.id,fieldClassify:s.fieldClassify,fieldname:this.refs[s.id].value,module:"PRODUCT"}}).then(function(t){l.default.success(t.data.message),a.setState({dataList:n})}).catch(function(t){l.default.error(t.statusText)})):l.default.error("请输入字段名")}},{key:"oCheckitem",value:function(t,e,a,n){var s=this.state.dataList;s[e].data[n].isChecked=t.target.checked?1:0,s[e].data[n].sort=this.num++,this.setState({dataList:s})}},{key:"onSortSubmit",value:function(t){var e=this,a=[];this.formAtDom(!1).sort(function(t,e){return t.sort-e.sort}).forEach(function(t,e){a.push(t.id)}),d.default.get("/hcm/hcmCustomModel/saveSort",{params:{ids:a.join(","),productClassifyId:this.state.id,module:"PRODUCT"}}).then(function(t){"10000"==t.data.status&&(l.default.success(t.data.message),e.props.onShow(!1,"getlist"))}).catch(function(t){l.default.error(t.statusText)})}},{key:"addButStatus",value:function(t,e){var a=this.state.dataList;a[t].addStatus=e,this.setState({dataList:a})}},{key:"addSubItem",value:function(t){var e=this;if(this.refs[t].value.trim().length)if(this.refs[t].value.trim().length>20)l.default.error("字段名过长 请限制在20字符以内");else{var a=this.state.dataList;a[t].addStatus=!1,d.default.get("/hcm/hcmCustomModel/save",{params:{productClassifyId:this.state.id,fieldClassify:t.toLocaleUpperCase(),fieldname:this.refs[t].value,module:"PRODUCT"}}).then(function(n){"10000"==n.data.status&&(n.data.data.sort=e.num++,a[t].data.push(n.data.data),e.setState({dataList:a})),l.default.success(n.data.message)}).catch(function(t){l.default.error(t.statusText)})}else l.default.error("请输入字段名")}},{key:"render",value:function(){var e=this,a=(this.state.visible,this.formAtDom(!1).sort(function(t,e){return t.sort-e.sort}));return t.createElement(n.default,{title:"设置表格",visible:this.props.visible,maskClosable:!1,onOk:function(){return e.onSortSubmit()},onCancel:function(){return e.props.onShow(!1)},className:"set-table-header",okButtonProps:{className:"btn2-main"},cancelButtonProps:{className:"btn2-sub"}},t.createElement("div",{className:"box"},t.createElement("div",{className:"left"},t.createElement("p",{className:"title"},"可用字段"),t.createElement("div",{className:"items"},this.formAtDom(!0))),t.createElement("div",{className:"right"},t.createElement("p",{className:"title"},"已选字段"),t.createElement(u.default,{className:"draggable-tree",draggable:!0,onDragStart:function(t){return e.onDragStart(t)},onDrop:function(t){return e.onDrop(t)}},a.map(function(a,n){return t.createElement(m,{title:t.createElement("div",{className:"TreeNode-title"},t.createElement("span",null,a.fieldname),"1"==a.fieldRequired?null:t.createElement(o.default,{onClick:function(){return e.canCelItem(a)},type:"close-circle"})),key:a.target.join(",")})})),t.createElement("p",{className:"footer"},"按上下拖动可排序"))))}}]),a}();e.default=h}).call(this,a(1))}}]);