(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{1076:function(e,t){},1077:function(e,t){},1093:function(e,t){},1099:function(e,t){},28:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var a=function(t){function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,e.Component),n(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return e.createElement("div",{className:this.props.clazzName?this.props.clazzName:"Copyright"},"Copyright © 杭州久点网络技术有限公司")}}]),a}();t.default=a}).call(this,n(1))},713:function(e,t){},753:function(e,t){},781:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(350)),l=v(n(14)),r=v(n(11)),i=v(n(25)),o=v(n(48)),c=v(n(19)),s=v(n(222)),u=v(n(30)),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(349),n(18),n(26),n(24),n(47),n(20),n(221),n(32);var p=v(n(13)),m=v(n(69)),h=v(n(28)),y=v(n(762));function v(e){return e&&e.__esModule?e:{default:e}}n(753);var g=u.default.Option,b=s.default.SHOW_ALL,_=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleChange=function(e){t.setState({notice_content:e})},t.getDepartmentList=function(){p.default.get("/hcm/department/fuByIds",{params:{id:0}}).then(function(e){if("10000"==e.data.status&&e.data.data){var n=e.data.data,a=t.state.departmentList;a=[{title:"全部",value:"all",key:"all",children:function e(t){return t.map(function(t,n){return null!=t.subSysDepartment?{title:t.departName,value:""+t.id,key:""+t.id,children:e(t.subSysDepartment)}:{title:t.departName,value:""+t.id,key:""+t.id}})}(n)}],t.setState({departmentList:a})}}).catch(function(e){c.default.error(e.statusText)})},t.chTreeSelect=function(e,n,a,l){var r=t.state;if("receive_departids"==l)if("all"===a.triggerValue)r[l]=a.checked?t.checkAll():[];else{var i=e.filter(function(e,t){return"all"==e.value});e.length==t.checkAll().length-1&&0==i.length?r[l]=t.checkAll():(i.length&&e.splice(0,1),r[l]=e)}else r[l]=e;t.setState(r)},t.onSubmit=function(){var e=t.state,n=e.notice_title,a=e.receive_departids,l=e.notice_type,r=e.notice_content,i=e.fileList;if(n&&0!=n.length)if(m.default.legnthCheck(n.trim(),"INPUT"))if(l)if(a&&0!=a.length){var o=document.createElement("div");o.innerHTML=r,null!=r&&0!=o.innerText.length?(LoadingModal({bl:!0,text:"提交中,请稍后..."}),-1!==a.findIndex(function(e){return"all"==e.value})&&a.splice(a.findIndex(function(e){return"all"==e.value}),1),p.default.post("/hcm/notice/Create",{notice_title:n,receive_departids:a.map(function(e,t){return e.value}).join(","),notice_type:l,notice_content:r,attach_urls:JSON.stringify(i)}).then(function(e){LoadingModal({bl:!1}),"10000"==e.data.status?(c.default.success("成功"),t.setState({fileList:[],receive_departids:[],notice_title:null,notice_type:null,notice_content:null},function(){window.location.href="/index.html#/Announcements"})):c.default.error(e.data.message)}).catch(function(e){c.default.error(e.statusText),LoadingModal({bl:!1})})):c.default.error("请输入内容")}else c.default.error("请选择接收部门");else c.default.error("请选择类型");else c.default.error("公告主题字符长度不能超过50");else c.default.error("请输入公告主题")},t.upChange=function(e){var n=e.fileList;t.beforeUpload(e.file,!1)&&t.setState({fileList:n})},t.beforeUpload=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.name,a=n.lastIndexOf("."),l=n.substr(a+1);return-1!==".rar .zip .doc .docx .xls .xlsx .ppt .pptx .pdf .jpg .png".indexOf(l)||(t&&c.default.error("暂不支持"+n+"文件格式"),!1)},t.state={dataList:[],noticeTypeList:[],departmentList:[],fileList:[],receive_departids:[],notice_title:null,notice_type:null,notice_content:null},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e.Component),f(n,[{key:"componentDidMount",value:function(){this.getNoticeTypeList(),this.getDepartmentList()}},{key:"getNoticeTypeList",value:function(){var e=this;p.default.get("/hcm/sys/GetList",{params:{dictcode:"notice_type"}}).then(function(t){e.setState({noticeTypeList:t.data.data})}).catch(function(e){c.default.error(e.statusText)})}},{key:"checkAll",value:function(){var e=[];return function t(n){n.forEach(function(n,a){var l=n.title,r=n.value;e.push({label:l,value:r}),n.children&&t(n.children)})}(this.state.departmentList),console.log(e),e}},{key:"render",value:function(){var t=this,n=this.state,c=n.noticeTypeList,f=n.departmentList,p=n.notice_title,m=n.receive_departids,v=n.notice_type,_=n.notice_content,E=n.fileList,w={contentFormat:"html",media:{allowPasteImage:!1,image:!1,video:!1,audio:!1},placeholder:"请输入公告内容",onChange:this.handleChange,initialContent:_,controls:["undo","redo","split","font-size","font-family","line-height","letter-spacing","indent","text-color","bold","italic","underline","strike-through","superscript","subscript","remove-styles","emoji","text-align","split","list_ul","list_ol","blockquote","code","split","link","split","clear"]},x={action:"/hcm/hcmWorkOrder/headUpload",onChange:this.upChange,beforeUpload:this.beforeUpload,multiple:!0};return e.createElement("div",{className:"add-announcements"},e.createElement("div",{className:"Breadcrumb"},e.createElement(o.default,null,e.createElement(o.default.Item,null,e.createElement("a",{href:"/index.html#/Announcements"},"通知公告")),e.createElement(o.default.Item,null,"新增公告"))),e.createElement("div",{className:"content"},e.createElement("ul",{className:"items"},e.createElement("li",{className:"item"},e.createElement("span",{className:"title red-ck"},"公告主题"),e.createElement("div",{className:"ipt-box"},e.createElement(i.default,{onChange:function(e){t.setState({notice_title:e.target.value})},value:p,placeholder:"请输入"}))),e.createElement("li",{className:"item"},e.createElement("span",{className:"title red-ck"},"公告类型"),e.createElement("div",{style:{position:"relative"},id:"alert-type",className:"ipt-box"},e.createElement(u.default,{style:{width:"100%"},showSearch:!0,placeholder:"请选择",getPopupContainer:function(){return document.getElementById("alert-type")},value:v||void 0,onChange:function(e,n,a){return t.chTreeSelect(e,n,a,"notice_type")},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},c.map(function(t,n){return e.createElement(g,{key:n,value:t.id},t.dictName)})))),e.createElement("li",{className:"item"},e.createElement("span",{className:"title red-ck"},"接收部门"),e.createElement("div",{style:{position:"relative"},id:"department",className:"ipt-box"},e.createElement(s.default,{allowClear:!0,multiple:!0,showSearch:!0,getPopupContainer:function(){return document.getElementById("department")},treeCheckStrictly:!0,placeholder:"请选择",treeCheckable:!0,showCheckedStrategy:b,treeDefaultExpandedKeys:["all"],style:{width:"100%"},dropdownStyle:{maxHeight:300,overflow:"auto"},value:m,treeData:f,onChange:function(e,n,a){return t.chTreeSelect(e,n,a,"receive_departids")}}))),e.createElement("li",{style:{width:"100%",alignItems:"end"},className:"item"},e.createElement("span",{className:"title red-ck"},"公告内容"),e.createElement("div",{style:{width:"80%",border:"1px solid #e5e5e5",borderRadius:"2px"},className:"ipt-box"},e.createElement(y.default,d({ref:function(e){return t.editorInstance=e}},w)))),e.createElement("li",{style:{width:"100%",alignItems:"end"},className:"item"},e.createElement("span",{style:{paddingTop:"8px"},className:"title"},"上传附件"),e.createElement("div",{className:"ipt-box"},e.createElement(a.default,d({},x,{fileList:E}),e.createElement(l.default,null,e.createElement(r.default,{type:"upload"})," 选择文件"),e.createElement("span",null,"支持扩展名：.rar .zip .doc .docx .xls .xlsx .ppt .pptx .pdf .jpg .png")))),e.createElement("li",{className:"item"},e.createElement("span",{className:"title"}),e.createElement("div",{className:"ipt-box"},e.createElement(l.default,{className:"upsure",onClick:function(){return t.onSubmit()}},"提交"),e.createElement("a",{href:"/index.html#/Announcements"},e.createElement(l.default,null,"取消")))))),e.createElement(h.default,{clazzName:"copyright"}))}}]),n}();t.default=_}).call(this,n(1))}}]);