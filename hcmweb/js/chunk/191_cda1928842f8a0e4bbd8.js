(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{862:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=c(n(23)),a=c(n(19)),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(22),n(20);var l=c(n(603)),s=c(n(13));function c(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var p={tb:"taobao",tm:"tmall",tmhk:"tmallhk"},d={goods:"item",shops:"shop"},g=function(e){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.handleRemoveFile=function(t){var n=e.state.fileList.slice().filter(function(e){return e.uid!==t.uid});e.setState({fileList:n})},e.handleBeforeUpload=function(t,e){var n=t.name.substring(t.name.lastIndexOf(".")+1),i=["jpg","png","bmp","pdf","zip","rar","doc","docx"].includes(n),o=t.size/1024/1024<5;return o||a.default.error("上传的文件必须小于 5MB!"),i||a.default.error("请按正确格式上传文件！"),i&&o},e.handleUploadChange=function(t){var n=t.fileList;if("done"===t.file.status){var i=t.file.response,o=(i.data,i.status),r=i.message;"10000"===o?a.default.success(r):a.default.error(r)}e.handleBeforeUpload(t.file)&&e.setState({fileList:n})},e.getComplaintAccount=function(){s.default.post("/hcm/complaiont/getListByBmcid",{platform:"ALIBABA"}).then(function(t){var n=t.data,i=n.data;n.message;"10000"===n.status&&e.setState({complatinAccountList:i})}).catch(function(t){a.default.error("系统繁忙，请稍后再试！")})},e.verifyLink=function(t){var n=e.state,i=n.complaintPlatform,o=n.complaintLinkType,r=n.linkList,l=n.complaintAccount;e.props.form.validateFieldsAndScroll(["complaintAccount","knowledgeRightTypeDetail"],function(n,c){if(!n){var u=c.knowledgeRightTypeDetail;if(!r.length)return void a.default.warning("请至少添加一条链接！");LoadingModal({bl:!0}),s.default.post("/hcm/taobaoCheckLink",{id:l,platform:i,cId:u,urlType:o,linkers:r.map(function(t){return"string"==typeof t?t:t.errorLink}).join(",")}).then(function(n){LoadingModal({bl:!1});var i=n.data,o=i.data,r=i.status,l=i.message;if("10000"===r){if(o.data){var s=o.data,c=s.success,u=s.error;e.setState({isVerifyLink:!0,linkList:u?u.map(function(t){return Object.assign({},{errorLink:t})}).concat(c||[]):c||[]},function(){t&&t()})}}else a.default.error(l)}).catch(function(t){LoadingModal({bl:!1}),e.catchError(t)})}})},e.getComplaintReason=function(t,n){e.getListFn("/hcm/getTaobaoIprReason",{platform:t,type:n},"complaintReasonList")},e.getKnowledgeRightTypeDetail=function(t){e.getListFn("/hcm/getTaobaoIpr",{type:t},"knowledgeRightTypeDetailList")},e.getKnowledgeRightType=function(t){e.getListFn("/hcm/getTaobaoiprType",{platform:t},"knowledgeRightTypeList")},e.getListFn=function(t,n,i){var a=e.state.complaintAccount;s.default.post(t,o({id:a},n)).then(function(t){var n=e.handleResponse(t);n&&e.setState(u({},i,[].concat(f(n))))}).catch(e.catchError)},e.catchError=function(t){a.default.error("系统繁忙，请稍后再试！")},e.handleResponse=function(t){var e=t.data,n=e.data.data,i=e.status,o=e.message;if("10000"===i)return n;a.default.error(o)},e.handleSubmit=function(t){t.preventDefault(),e.verifyLink(function(){var t=e.state,n=t.complaintPlatform,i=t.knowledgeRightTypeList,o=t.knowledgeRightTypeDetailList,r=t.complaintReasonList,l=t.complaintLinkType,c=t.linkList,u=t.fileList;(0,e.props.form.validateFieldsAndScroll)(function(t,f){if(!t){if(f.reportComment.length>1500)return void a.default.warning("投诉理由超过1500字，请修改！");var p,g,m,h="";r.forEach(function(t){t.items.forEach(function(t){t.id===f.reason&&(h=t.text)})}),p=i.filter(function(t){return t.id==f.knowledgeRightType})[0].text,g=o.filter(function(t){return t.id==f.knowledgeRightTypeDetail})[0].text,m=u.length?u.map(function(t){return t.response.data.url}).join(","):"";var k={id:f.complaintAccount,platform:n,iprName:p,type:f.knowledgeRightType,cName:g,cId:f.knowledgeRightTypeDetail,urlType:l,reasonText:l===d.goods?h:"明显假冒",reason:l===d.goods?f.reason:"frontReason.trademark.fake.mxjh",reportComment:f.reportComment,links:c.map(function(t){return"string"==typeof t?t:t.errorLink}).join(","),url:m};LoadingModal({bl:!0}),s.default.post("/hcm/taobaoComplaint",k).then(function(t){LoadingModal({bl:!1});var n=t.data,i=(n.data,n.status),o=n.message;"10000"===i?(a.default.success(o),e.props.form.resetFields(),e.setState({linkList:[],isVerifyLink:!1,complaintReasonId:"",fileList:[]})):a.default.error(o)}).catch(function(t){LoadingModal({bl:!1}),e.catchError(t)})}})})},e.handleRadioChange=function(t,n){e.setState(u({},t,n.target.value)),"complaintPlatform"===t&&e.props.form.validateFields(["complaintAccount"],function(t,i){t||e.getKnowledgeRightType(n.target.value)})},e.handleSelect=function(t,n){"knowledgeRightType"===t?(e.props.form.resetFields(["knowledgeRightTypeDetail"]),e.getKnowledgeRightTypeDetail(n),e.getComplaintReason(e.state.complaintPlatform,n)):"complaintAccount"===t?(e.props.form.resetFields(["knowledgeRightType","knowledgeRightTypeDetail","reason"]),e.setState(u({},t,n),function(){e.getKnowledgeRightType(e.state.complaintPlatform)})):e.setState(u({},t,n))},e.handleLinkItemBlur=function(){var t=e.state.linkList.slice();e.setState({current_link_item:-1,linkList:Array.from(new Set(t))})},e.handleLinkItemChange=function(t,n){var i=n.target.value,a=e.state.linkList.slice();a[t]=i,e.setState({linkList:a,isVerifyLink:!1})},e.handleLinkItemEdit=function(t){e.setState({current_link_item:t})},e.handleLinkItemDelete=function(t){var n=e.state.linkList.slice();n.splice(t,1),e.setState({linkList:n,isVerifyLink:!1})},e.handleLinkChange=function(t){e.state.linkList.slice().length<300?e.setState({link_textarea_value:t.target.value}):a.default.warning("超出限制！")},e.handleLinkBlur=function(t){var n=t.target.value.split("\n"),i=e.state.linkList.slice().concat(n),a=new Set(i.filter(function(t){return""!==t})),o=Array.from(a);e.setState({linkList:[].concat(f(o)),link_textarea_value:""})},e.state={linkList:[],link_textarea_value:"",current_link_item:-1,complaintAccount:"",complatinAccountList:[],knowledgeRightTypeList:[],knowledgeRightTypeDetailList:[],complaintPlatform:p.tb,complaintLinkType:d.goods,complaintReasonList:[],complaintReasonId:"",fileList:[],showFileList:[],isVerifyLink:!1},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t.Component),r(n,[{key:"componentWillMount",value:function(){this.getComplaintAccount()}},{key:"render",value:function(){return t.createElement(l.default,{that:this})}}]),n}();e.default=i.default.create()(g)}).call(this,n(1))}}]);