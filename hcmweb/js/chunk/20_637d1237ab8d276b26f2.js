(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1098:function(t,e){},165:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(720);e.default={Encrypt:function(t){var e=n.enc.Utf8.parse("hcmabcdefghijklm"),a=n.enc.Utf8.parse(t);return n.AES.encrypt(a,e,{mode:n.mode.ECB,padding:n.pad.Pkcs7}).toString()},Decrypt:function(t){var e=n.enc.Utf8.parse("hcmabcdefghijklm"),a=n.AES.decrypt(t,e,{mode:n.mode.ECB,padding:n.pad.Pkcs7});return n.enc.Utf8.stringify(a).toString()}}},769:function(t,e,a){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var i=p(a(23)),s=p(a(347)),o=p(a(11)),u=p(a(130)),c=p(a(19)),l=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();a(22),a(348),a(26),a(169),a(20);var r=p(a(595)),d=p(a(13)),f=p(a(165)),m=p(a(69));function p(t){return t&&t.__esModule?t:{default:t}}function h(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var g=function(e){function a(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return i.actionVisible=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.setState({actionVisible:t,targetData:e},function(){t&&e.alid&&i.getOldaliList(e.alid),t&&e.jdid&&i.getOldjdList(e.jdid),i.setState({jdList:[],aliList:[],oldaliList:[],oldjdList:[]})})},i.getVersionList=function(){d.default.get("/hcm/sys/GetList",{params:{dictcode:"version"}}).then(function(t){i.setState({versionList:t.data.data})})},i.onBindSubmit=function(t,e){t.bmcid=i.state.targetData.bmcid,t.ALcomplaiontId=t.ALcomplaiontId.join(","),t.JDcomplaiontId=t.JDcomplaiontId.join(","),t.oldALcomplaiontId=i.state.targetData.alid,t.oldJDcomplaiontId=i.state.targetData.jdid,i.actionVisible(!1),i.setState({login:!0},function(){d.default.post("/hcm/complaiont/saveBmcid",t).then(function(t){"10000"==t.data.status?(i.getList(),e(),c.default.success(t.data.message),i.setState({login:!1})):(i.setState({login:!1}),c.default.error(t.data.message))}).catch(function(t){i.setState({login:!1}),c.default.error(t.statusText)})})},i.getComplaintsAccountListAli=function(t){""!=t?d.default.get("/hcm/complaiont/getList",{params:{platform:"ALIBABA",checkedids:i.state.oldaliList.map(function(t,e){return t.id}).join(","),keyword:t}}).then(function(t){i.setState({aliList:t.data.data})}).catch(function(t){c.default.error(t.statusText)}):i.setState({aliList:[]})},i.getComplaintsAccountListJd=function(t){""!=t?d.default.get("/hcm/complaiont/getList",{params:{platform:"JINGDONG",checkedids:i.state.oldjdList.map(function(t,e){return t.id}).join(","),keyword:t}}).then(function(t){i.setState({jdList:t.data.data})}).catch(function(t){c.default.error(t.statusText)}):i.setState({jdList:[]})},i.fetchUser=function(t,e){"aliList"==e?i.getComplaintsAccountListAli(t):i.getComplaintsAccountListJd(t)},i.onSelectBlur=function(t,e){i.setState(h({},e,[]))},i.getOldaliList=function(t){d.default.get("/hcm/complaiont/getMapByCheckids",{params:{platform:"ALIBABA",checkedids:t}}).then(function(t){i.setState({oldaliList:t.data.data||[]})}).catch(function(t){c.default.error(t.statusText)})},i.getOldjdList=function(t){d.default.get("/hcm/complaiont/getMapByCheckids",{params:{platform:"JINGDONG",checkedids:t}}).then(function(t){i.setState({oldjdList:t.data.data||[]})}).catch(function(t){c.default.error(t.statusText)})},i.onSelect=function(t,e,a,n){var s,o=i.state[a],u=o.filter(function(e,a){return e.id==t}),c=i.state[n];c.push(u[0]),i.setState((h(s={},n,c),h(s,a,o.filter(function(e,a){return e.id!=t})),s))},i.onDeselect=function(t,e,a,n){var s,o=i.state[n],u=o.filter(function(e,a){return e.id==t}),c=i.state[a];c.push(u[0]),i.setState((h(s={},n,o.filter(function(e,a){return e.id!=t})),h(s,a,c),s))},i.Department=function(t){window.location="/index.html#/DepartmentManagements/"+t.bmcid+"/"+t.companyname},i.getUserCustomer=function(){d.default.get("/hcm/userin/getUserCustomer",{params:{status:1}}).then(function(t){console.log(t),i.setState({customerList:t.data.data})}).catch(function(t){c.default.error(t.statusText)})},i.getRolePage=function(){d.default.get("/hcm/role/getRolePage",{params:{pageNo:1,pageSize:999}}).then(function(t){i.setState({rolePage:t.data.data.content})})},i.chSearchIpt=function(t,e){var a=i.state;a[e]=t.target.value,i.setState(a)},i.handleClearIconClick=function(t){var e=i.state;e[t]=null,i.setState(e)},i.seSearchIpt=function(t,e){var a=i.state;a[e]=t,i.setState(a)},i.onSearch=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.setState({pageNo:1,version:t?null:i.state.version,companyname:t?null:i.state.companyname,username:t?null:i.state.username,status:t?null:i.state.status,kefu:t?null:i.state.kefu,companyMemoname:t?null:i.state.companyMemoname,oldSearch:{version:t?null:i.state.version,companyname:t?null:i.state.companyname,username:t?null:i.state.username,status:t?null:i.state.status,kefu:t?null:i.state.kefu,companyMemoname:t?null:i.state.companyMemoname}},function(){i.getList()})},i.getList=function(){var t=i.state,e=t.version,a=t.companyname,n=t.username,s=t.status,o=t.companyMemoname,u=t.kefu,l=t.pageNo,r=t.pageSize;d.default.get("/hcm/userout/getUserPage",{params:{version:e,companyname:a,status:s,kefu:u,username:n,companyMemoname:o,pageNo:l,pageSize:r}}).then(function(t){i.setState({dataList:t.data.data.content,pageNo:t.data.data.pageNumber,pageSize:t.data.data.pageSize,totalNum:t.data.data.totalElements},function(){i.allClick(!0)})}).catch(function(t){c.default.error(t.statusText)})},i.allClick=function(e){var a=i.state.columns;if(1==e)return"checkStatue"==a[0].key&&a.splice(0,1),void i.setState({columns:a});"checkStatue"==a[0].key?a.splice(0,1):a.unshift({title:"",dataIndex:"checkStatue",key:"checkStatue",width:"4%",render:function(e,a,n){return t.createElement(u.default,{checked:a.checkStatue,onChange:function(t){return i.onCheckbox(t,e,a,n)}})}}),i.setState({columns:a})},i.checkAll=function(t){var e=i.state.dataList;e.forEach(function(e,a){e.checkStatue=t}),i.setState({dataList:e,checkAll:t})},i.changePagination=function(t,e){i.setState({pageNo:t,pageSize:e},function(){i.getList()})},i.onPaginationSize=function(t,e){i.setState({pageNo:1,pageSize:e},function(){i.getList()})},i.fullSpinVisible=function(t){i.setState({fullSpinVisible:t})},i.allStart=function(){var t=[],e=i.state.oldSearch,a=e.companyname,n=e.username,s=e.companyMemoname,o=e.status,u=e.kefu,l=e.version;i.state.dataList.filter(function(t,e){return t.checkStatue}).forEach(function(e,a){t.push(e.userid)}),0!=t.length?(i.fullSpinVisible(!0),d.default.post("/hcm/user/StartOrStop",{userIds:i.state.checkAll?"checkAllBmc":t.join(","),status:1,usertype:"c",companyname:i.state.checkAll?a:"",username:i.state.checkAll?n:"",companyMemoname:i.state.checkAll?s:"",status1:i.state.checkAll?o:"",kefu:i.state.checkAll?u:"",version:i.state.checkAll?l:""}).then(function(t){i.fullSpinVisible(!1),"10000"==t.data.status?(i.onSearch(!0),c.default.success(t.data.message)):c.default.error(t.data.message)}).catch(function(t){i.fullSpinVisible(!1),c.default.error(t.statusText)})):c.default.error("至少选择一条")},i.allStop=function(){var t=[],e=i.state.oldSearch,a=e.companyname,n=e.username,s=e.companyMemoname,o=e.status,u=e.kefu,l=e.version;i.state.dataList.filter(function(t,e){return t.checkStatue}).forEach(function(e,a){t.push(e.userid)}),0!=t.length?(i.fullSpinVisible(!0),d.default.post("/hcm/user/StartOrStop",{userIds:i.state.checkAll?"checkAllBmc":t.join(","),status:0,usertype:"c",companyname:i.state.checkAll?a:"",username:i.state.checkAll?n:"",companyMemoname:i.state.checkAll?s:"",status1:i.state.checkAll?o:"",kefu:i.state.checkAll?u:"",version:i.state.checkAll?l:""}).then(function(t){i.fullSpinVisible(!1),"10000"==t.data.status?(i.onSearch(!0),c.default.success(t.data.message)):c.default.error(t.data.message)}).catch(function(t){i.fullSpinVisible(!1),c.default.error(t.statusText)})):c.default.error("至少选择一条")},i.aAction=function(t,e,a){d.default.post(t,{userIds:e,status:a,usertype:"c"}).then(function(t){c.default.success(t.data.message),"10000"==t.data.status&&i.getList()}).catch(function(t){c.default.error(t.statusText)})},i.handleSubmit=function(t){t.preventDefault();var e=function(t,e){d.default.post(t,e).then(function(t){LoadingModal({bl:!1}),c.default.success(t.data.message),"10000"==t.data.status&&(i.stateModal(!1,"",!1),i.getList())}).catch(function(t){LoadingModal({bl:!1}),c.default.error(t.statusText)})};i.props.form.validateFields(function(t,a){if(!t){var s=i.state,o=s.targetModal,u=s.type;if(o.userid?a.userId=o.userid:a.userId=null,o.bid?a.bid=o.bid:a.bid=null,a.validtime=n(a.validtime).format("YYYY-MM-DD"),!m.default.required(a.companyname))return void c.default.error("请输入公司名称");if(!m.default.legnthCheck(a.companyname,"INPUT"))return void c.default.error("公司名称长度不允许超过50");if("新增"==u&&!m.default.checkAccount(a.username))return void c.default.error("请按照要求用户名");if(!m.default.checkPassword(a.password))return void c.default.error("密码长度不符");if(!m.default.required(a.kefuid)||a.kefuid&&0==a.kefuid.length)return void c.default.error("请选择服务客服");if(!m.default.legnthCheck(a.memo,"URL"))return void c.default.error("备注说明长度不允许超过500");LoadingModal({bl:!0,text:"保存中,请稍后..."}),a.companyname=m.default.trim(a.companyname),a.username=m.default.trim(a.username),a.password=f.default.Encrypt(m.default.trim(a.password)),a.kefuid=a.kefuid.join(","),"新增"==u?(a.userId="",a.bid="",e("/hcm/userout/saveUserOut",a)):"编辑"==u&&e("/hcm/userout/saveUserOut",a)}})},i.stateModal=function(t,e,a){!1===a&&(a={username:null,companyname:null,roleIds:null,versionid:null,kefu:null,Date:null,password:"******",memo:null}),a.password="******",a.roleIds=a.roleid,i.setState({visible:t,type:e,targetModal:a})},i.unBindphone=function(t){d.default.get("/hcm/user/UnbindPhone",{params:{mobiles:t.userid,usertype:"c"}}).then(function(t){c.default.success(t.data.message),"10000"==t.data.status&&i.getList()}).catch(function(t){c.default.error(t.statusText)})},i.allEditService=function(){var t=[],e=[];if(!m.default.required(i.state.oService)||i.state.oService&&0==i.state.oService.length)c.default.error("请选择服务客服");else{var a=i.state.oldSearch,n=a.companyname,s=a.username,o=a.companyMemoname,u=a.status,l=a.kefu,r=a.version;i.state.dataList.filter(function(t,e){return t.checkStatue}).forEach(function(a,n){t.push(a.userid),e.push(a.bid)}),d.default.post("/hcm/cus/multil_update_kefu",{bmcids:i.state.checkAll?null:e.join(","),userIds:i.state.checkAll?null:t.join(","),kefu:i.state.oService.join(","),checkAll:!!i.state.checkAll||null,companyname:i.state.checkAll?n:"",username:i.state.checkAll?s:"",companyMemoname:i.state.checkAll?o:"",status:i.state.checkAll?u:"",kefu1:i.state.checkAll?l:"",version:i.state.checkAll?r:""}).then(function(t){"10000"==t.data.status?(c.default.success(t.data.message),i.setState({editService:!1,oService:[]},function(){i.getList()})):c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})}},i.selectService=function(t){i.setState({oService:t})},i.stateEditService=function(t){0!=i.state.dataList.filter(function(t,e){return t.checkStatue}).length?i.setState({editService:t,oService:[]}):c.default.error("至少选择一条")},i.state={fetching:!1,versionList:[],version:null,actionVisible:!1,jdList:[],aliList:[],oldaliList:[],oldjdList:[],targetData:{},rolePage:[],login:!1,fullSpinVisible:!1,type:null,oService:[],dataList:[],editService:!1,oldSearch:{companyname:null,username:null,companyMemoname:null,status:null,kefu:null},targetModal:{bid:null,username:null,roleIds:null,versionid:null,companyname:null,kefu:null,validtime:null,password:"******",memo:null,companyMemoname:null},customerList:[],companyname:null,status:null,username:null,companyMemoname:null,kefu:null,pageNo:1,pageSize:10,checkAll:!1,totalNum:null,columns:[{title:"序号",dataIndex:"index",key:"index",width:"5%",render:function(t,e,a){return a+1}},{title:"客户名称",dataIndex:"companyname",key:"companyname",width:"10%",render:function(e,a,n){return t.createElement("a",{onClick:function(){return i.Department(a)}},a.companyname)}},{title:"用户名",dataIndex:"username",key:"username",width:"10%"},{title:"绑定手机",dataIndex:"mobile",key:"mobile",width:"10%",render:function(e,a){return t.createElement("div",null,e&&e.length?e:"--",e&&e.length?t.createElement("span",{onClick:function(){return i.unBindphone(a)},className:"unphone"},t.createElement(o.default,{type:"link"}),"解绑手机"):null)}},{title:"服务客服",dataIndex:"kefuname",key:"kefuname",width:"10%"},{title:"备注说明",dataIndex:"memo",key:"memo",width:"10%"},{title:"备注名",dataIndex:"companyMemoname",key:"companyMemoname",width:"10%"},{title:"账号有效期",dataIndex:"validtime",key:"validtime",width:"10%",render:function(t){return t?n(t).format("YYYY-MM-DD"):null}},{title:"状态",dataIndex:"status",key:"status",width:"4%",render:function(e,a,n){return t.createElement(s.default,{checked:"1"==e,onChange:function(){return i.aAction("/hcm/user/StartOrStop",a.userid,"1"==e?0:1)},checkedChildren:"开",unCheckedChildren:"关",defaultChecked:!0})}},{title:"操作",key:"action",align:"right",width:"10%",render:function(e,a,n){return t.createElement("span",{key:"index"},t.createElement("a",{onClick:function(){return i.stateModal(!0,"编辑",a)}},t.createElement("img",{style:{verticalAlign:"text-bottom",paddingRight:"4px"},src:"../../../img/icon/icon_operating_edit.png"}),"编辑"),t.createElement("a",{style:{marginLeft:10},onClick:function(){return i.actionVisible(!0,a)}},"绑定"))}}]},i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,t.Component),l(a,[{key:"componentDidMount",value:function(){this.getList(),this.getUserCustomer(),this.getRolePage(),this.getVersionList()}},{key:"onCheckbox",value:function(t,e,a,n){var i=this.state.dataList;i[n].checkStatue?i[n].checkStatue=!1:i[n].checkStatue=!0,this.setState({dataList:i,checkAll:!1})}},{key:"render",value:function(){return t.createElement(r.default,{that:this})}}]),a}();e.default=i.default.create()(g)}).call(this,a(1),a(10))}}]);